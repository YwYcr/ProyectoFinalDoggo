@model IEnumerable<ProyectoFinalDoggo.Models.Productos>

@{
    ViewBag.Title = "Carrito";
    Layout = "~/Views/Shared/DoggoLayout.cshtml";
}

<h2>Carrito</h2>



<table class="table">


    <tr>
        <th>Imagen del producto</th>
        <th>Producto</th>
        <th>Cantidad</th>
        <th>Acciones</th>
    </tr>

    @if (Session != null && Session["cart"] != null)
    {
        foreach (var prod in Model)
        {
            <tr>
                <td>
                    <img src="@prod.imagen" alt="Imagen del Producto" width="200" height="150" />
                </td>
                <td>
                    @Html.DisplayFor(modelItem => prod.nomProducto)
                </td>
                <td>
                    @Html.TextBoxFor(modelItem => prod.cantidad, new { @class = "form-control", type = "number", min = "1", max = "10", id = "cantidad_" + prod.IDProd })
                    <a href="javascript:void(0);" class="btn btn-primary"
                       onclick="actualizarCantidad('@Url.Action("modificarCantidad")', '@prod.IDProd')">Actualizar</a>
                </td>
                <td>
                    <a href="@Url.Action("deleteItemCarrito", new { id = prod.IDProd })" title="Eliminar" onclick="return confirm('¿Estás seguro de que deseas eliminar este producto?')">
                        <i class="fas fa-trash"></i>
                    </a>
                </td>

            </tr>

        }

    }
    else
    {
        <p>No hay productos</p>
    }


</table>

<script>
    function actualizarCantidad(url, IDProd) {
        var cantidad = $("#cantidad_" + IDProd).val(); // Obtén el valor del cuadro de texto usando el ID del producto
        window.location.href = url + "?id=" + IDProd + "&cantidad=" + cantidad; // Redirige a la URL del enlace con los parámetros actualizados
    }
</script>

@if (Session != null && Session["cart"] != null)
{
    <a href="@Url.Action("confirmarCompra")" class="btn btn-primary">Confirmar Compra</a>
    <a href="@Url.Action("limpiarCarrito")" class="btn btn-primary">Limpiar Carrito</a>
}







